
## 1. 세션의 정의와 특징

### 1-1. 세션(Session)이란?
세션은 사용자의 정보를 데이터베이스에 저장하고 상태를 유지하는 도구

### 1-2. 세션의 특징
  <div style="flex: 1; padding: 10px;">
    <ol>
      <li>세션은 고유한 ID 값으로 구성됩니다.</li>
      <li>세션은 서버에서 생성되며, 클라이언트에 쿠키 형태로 저장된다.</li>
      <li>클라이언트가 요청을 보낼 때, 세션 ID를 포함하여 서버에 전달하면 서버는 이를 통해 사용자를 식별할 수 있다. =>  매번 아이디와 비밀번호를 물어볼 필요가 없습니다.</li>
      <li> 🙅‍♀️ : 세션 ID는 데이터베이스에 저장되므로, 서버는 요청이 있을 때마다 데이터베이스에서 세션 ID를 확인해야 한다. </li>
      <li> 🙆‍♀️ 데이터가 서버에 저장되므로 클라이언트에 사용자 정보가 노출될 위험이 없다.</li>
      <li>세션을 데이터베이스에 저장하기 때문에 **수평 확장(Horizontal Scaling)**이 어렵다.</li>
    </ol>
  </div>

<details><summary> 💡 수평 확장(Horizontal Scaling)
</summary>

- 시스템의 처리 능력을 확장하기 위해 리소스를 추가하는 방법
- **수직 확장(Vertical Scaling)**: 기존 시스템에 자원을 추가하는 방식 (예: CPU, RAM 추가).
 - **수평 확장(Horizontal Scaling)**: 여러 시스템을 병렬로 추가하는 방식 (예: 웹 서버를 여러 대 추가하여 더 많은 트래픽 처리).
  - **로드 밸런서(Load Balancer)**를 통해 요청을 여러 서버로 분산시켜 안정성과 가용성을 높인다.
   - **EKS**와 같은 오케스트레이션 도구를 사용해 효율적으로 서비스 확장 및 관리를 수행.
</details>
---
## 2. 토큰의 정의와 특징

### 2-1. 토큰(Token)이란?
토큰은 사용자의 정보를 Base64로 인코딩된 문자열로 저장하는 도구

### 2-2. 토큰의 특징
<div style="display: flex; justify-content: space-between;">
  <div style="flex: 1; padding: 10px;">
    <ol>
      <li>토큰은 <strong>헤더(Header)</strong>, <strong>페이로드(Payload)</strong>, <strong>서명(Signature)</strong>으로 구성되어 있으며, 모두 Base64로 인코딩되어 있다.</li>
      <li>토큰은 서버에서 생성되어 클라이언트 측에 저장된다 (세션과 유사).</li>
   <li> 토큰은 데이터베이스가 필요 없으므로 수평 확장이 용이</li>
<li>클라이언트는 요청 시 토큰을 함께 전송하여 서버에서 사용자를 식별한다 (세션과 유사).</li>
<li>토큰은 서명(Signature)을 사용해 검증되므로 데이터베이스를 매번 확인할 필요가 없다.
<li> 🙅‍♀️토큰에 모든 정보가 포함되어 있어, 토큰이 유출될 경우 정보 노출의 위험이 있다. 
    </ol>
  </div>
</div>

---

## 3. 세션 흐름

💡 **쿠키(Cookie)**
- 쿠키는 웹 서버가 생성하여 웹 브라우저로 전송하는 작은 정보 일
- 웹 브라우저는 쿠키를 미리 정해진 기간 동안 또는 사용자 세션 동안 저장하며, 서버에 요청을 보낼 때 해당 쿠키를 첨부한다.

### 3-1. 세션 생성 과정
![](https://velog.velcdn.com/images/hyeminililo/post/84cc170e-92be-4e62-849a-45cb076b9217/image.png)
1. ID/비밀번호 전송
2. 데이터베이스에서 검증
3. 세션 생성 및 데이터베이스에 저장
4. 세션 쿠키를 클라이언트에 전송

### 3-2. 세션 사용 방식 (예: 장바구니)
![](https://velog.velcdn.com/images/hyeminililo/post/9dd3d4f8-5a54-4e48-add7-5340cbfc00c9/image.png)

---
## 4. 토큰 흐름

### 4-1. 토큰 생성 과정

  ![](https://velog.velcdn.com/images/hyeminililo/post/9455f3b8-808a-4978-98cb-6ec87d9a8d9c/image.png)

1. ID/비밀번호 전송
2. 자격 증명 검증 후 바로 토큰 발급 (데이터베이스에 저장하지 않음)
3. 토큰을 클라이언트에 전송

### 4-2. 토큰 사용 방식

![](https://velog.velcdn.com/images/hyeminililo/post/e69823a3-72a6-4bb2-b63b-cf84e74c9573/image.png)


1. 요청 시 헤더에 토큰을 포함하여 전송
2. 서버는 토큰의 서명을 검증하여 인증 진행 (데이터베이스 확인 불필요)
---
## 5. 세션과 토큰의 비교

### 5-1. Session vs. Token

| 비교 항목 | 세션 | 토큰 |
| --- | --- | --- |
| **저장 위치** | 서버 | 클라이언트 |
| **클라이언트가 보내는 정보** | 쿠키 | 토큰 |
| **데이터베이스 확인 필요 여부** | 필요 | 불필요 (서명 검증) |
| **클라이언트에서 인증 정보 확인 가능 여부** | 불가능 | 가능 |
| **수평 확장 용이성** | 어려움 | 쉬움 |

### 5-2. 적합한 사용 사례

| 비교 요소 | Session | Token |
| --- | --- | --- |
| 적합한 사용 사례 | 쇼핑몰 장바구니,  내부시스템 관리 페이지 | 모바일 앱 , API 중심 서비스 |
| 단기 세션 관리 | Session 방식이 적합 (짧은 시간 동안 상태 유지) | Token 방식 적합하지 않음|
| API 기반 인증 | 적합하지 않음 (세션 저장소 필요) | RESTful API, GraphQL 등의 API 서비스에서 적합 |

### 5-3. 장단점

| **항목** | **Session** | **Token** |
| --- | --- | --- |
| 장점 | 클라이언트에 민감한 정보 저장 X → 높은 보안성, 세션 ID만으로 인증 가능 | 서버에 인증 상태 저장 필요 없음 → 확장성 높음, API 중심 서비스에서 적합 |
| 단점 | 서버 측 리소스 사용 (세션 저장소, DB 조회 등),Horizontal Scaling 어려움|  클라이언트에 민감한 정보가 노출될 가능성, 토큰 크기로 인해 네트워크 부하 가능 |


### 5-4. 세션과 토큰의 혼합 사용

**Access Token + Refresh Token + 세션 혼합 사용 예시**

1. **Access Token**: 짧은 만료 시간을 가진 인증 토큰.
2. **Refresh Token**: 긴 만료 시간을 가진 재발급용 토큰.
3. **Session**: 일부 사용자 상태를 저장하여 인증 프로세스를 보완 (예: 로그인 상태 유지).

**적용 사례**
- **대규모 분산 시스템**: 토큰 기반의 API 인증을 사용하면서 일부 민감한 데이터는 서버 세션으로 관리.
- **OAuth2 예시**: Access Token, Refresh Token, 세션을 혼합하여 사용.

### 5-5. 기술 스택 추천

- **세션 기반 인증**:
  - **Express.js (Node.js)**: `express-session` 패키지.
  - **Spring Framework (Java)**: 기본 세션 관리 기능.
- **토큰 기반 인증**:
  - **JWT**: `jsonwebtoken` (Node.js), `jjwt` (Java).
  - **OAuth2 지원**: Auth0, Okta.
